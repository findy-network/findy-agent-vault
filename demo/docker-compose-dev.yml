version: "3"
services:
  agency:
    build:
      context: .docker/findy-agent-cli/agency
      args:
        HTTPS_PREFIX: ${HTTPS_PREFIX}
    ports:
      - "8080:8080"
      - "50052:50051"
    volumes:
      - .docker/findy-common-go/cert:/cert
      - ./conf/steward.exported:/steward.exported
      - ./conf/genesis_transactions:/genesis_transactions
    environment:
      FCLI_AGENCY_SALT: "salt"
      FCLI_AGENCY_HOST_ADDRESS: "agency"
      FCLI_AGENCY_HOST_PORT: "8080"
      FCLI_AGENCY_GRPC_CERT_PATH: "/cert"
      FCLI_POOL_NAME: "FINDY_FILE_LEDGER"
      FCLI_AGENCY_POOL_NAME: "FINDY_FILE_LEDGER"

  vault-db:
    image: postgres:13.1-alpine
    environment:
      POSTGRES_PASSWORD: "my-secret-password"
      POSTGRES_DB: vault
    volumes:
      - ./.docker/db/data:/var/lib/postgresql/data
    ports:
      - "5432:5432"
